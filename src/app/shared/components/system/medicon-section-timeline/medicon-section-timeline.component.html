<ng-container
    [ngTemplateOutlet]="header"
    [ngTemplateOutletContext]="{isTop: true}">
</ng-container>

<div #categories>
  <app-medicon-category
    *ngFor="let category of section.categories; let i=index"
    [category]="category"
    (expandCondense)="onExpandCondense()">
  </app-medicon-category>
</div>

<!--
<app-medicon-timeline-values
    [timeline]="timeline"
    [medicationsAreaWidth]="medicationsAreaWidth"
    [timelineWidth]="timelineWidth">
</app-medicon-timeline-values>
-->

<ng-container
    [ngTemplateOutlet]="header"
    [ngTemplateOutletContext]="{isTop: false}">
</ng-container>

<ng-template #header let-isTop="isTop">
  <div class="header vertical-center" [class.top]="isTop" [class.bottom]="!isTop">
    <div class="action-icons horizontal-left vertical-center">
      <span class="legend-title"
            [popover]="legendTemplate"
            [placement]="'bottom'"
            [container]="'body'"
            [isOpen]="false"
            [triggers]="'hover'">{{text.medicon.legend}}</span>
      <span><i class="bi bi-plus-circle"></i></span>
      <span><i class="bi bi-alarm"></i></span>
    </div>
    <div><span *ngIf="isTop" class="horizontal-center">{{section.name}}</span></div>
    <div *ngIf="isTop" class="horizontal-right">
      <app-medicon-resolution
          [text]="text"
          [timelineValues]="timelineValues"
          (changeResolution)="onChangeResolution($event)"
      ></app-medicon-resolution>
    </div>
  </div>
</ng-template>

<ng-template #legendTemplate>
  <div class="legend" [dir]="direction">
    <ng-container *ngFor="let column of legendColumns; let i=index">
      <ul>
        <li *ngFor="let item of column">
          <div class="vertical-center">
            <app-medicon-icon [type]="item.type" [position]="'aligned'"></app-medicon-icon>
            <span>{{text.medicon.icons[item.type]}}</span>
          </div>
        </li>
      </ul>
    </ng-container>
  </div>
</ng-template>
